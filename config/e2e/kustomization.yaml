apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../default

patches:
  - patch: |-
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        name: controller-manager
        namespace: system
      spec:
        template:
          spec:
            containers:
              - name: manager
                volumeMounts:
                  - mountPath: /etc/ssl/certs/
                    name: ca-certs
                    readOnly: true
            volumes:
              - name: ca-certs
                configMap:
                  name: docker-registry.catalogd-e2e.svc
                  defaultMode: 0644
                  optional: false
                  items:
                    - key: ca-certificates.crt
                      path: ca-certificates.crt